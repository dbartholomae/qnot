(this.webpackJsonpqnot=this.webpackJsonpqnot||[]).push([[0],{119:function(e,t){},1618:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(10),o=n.n(i);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=n(46),s=n(14);var l=n(29),u=n(22),d=n(17),j=n(1667);function b(e,t){return localStorage.setItem("qnot/".concat(e),t),t}function m(e){var t;return null!==(t=localStorage.getItem("qnot/".concat(e)))&&void 0!==t?t:null}var O={id:function(){var e;return null!==(e=m("id"))&&void 0!==e?e:b("id",Object(j.a)())}(),name:m("name")},h=Object(u.b)({name:"me",initialState:O,reducers:{setName:function(e,t){return Object(d.a)(Object(d.a)({},e),{},{name:t.payload})}}}),f=function(e){return e.me.name},v=function(e){return e.me.id},p=h.actions.setName,x=h.reducer,g=function(){return Object(l.b)()},y=l.c;function w(){var e=y(f),t=g();return[e,function(e){b("name",e),t(p(e))}]}var C=n(37),S=function e(t){var n=t.id,a=void 0===n?Object(j.a)():n,r=t.name,i=t.isOnline;Object(C.a)(this,e),this.id=void 0,this.name=void 0,this.isOnline=void 0,this.word=void 0,this.descriptions=[],this.guesses=[],this.name=r,this.isOnline=i,this.id=a},G=n(12),R=Object(u.b)({name:"players",initialState:{},reducers:{addOrUpdatePlayer:function(e,t){var n=t.payload;return Object(d.a)(Object(d.a)({},e),{},Object(G.a)({},n.id,n))},markPlayerOffline:function(e,t){var n=t.payload;void 0!==e[n]&&(e[n].isOnline=!1)}}}),V=R.actions,k=V.addOrUpdatePlayer,W=V.markPlayerOffline,L=function(e){return Object.values(e.players)},T=R.reducer;var D,P=Object(u.b)({name:"roomSettings",initialState:{isHost:!1},reducers:{setHost:function(e,t){return Object(d.a)(Object(d.a)({},e),{},{isHost:t.payload})}}}),H=P.actions.setHost,I=function(e){return function(e){return e.roomSettings}(e).isHost},M=P.reducer,F=n(81),N=n.n(F);function q(e){return e%2===0}!function(e){e.WaitingForGameStart="WaitingForGameStart",e.ChoosingFirstDescription="ChoosingFirstDescription",e.GuessingFirstTeam="GuessingFirstTeam",e.ChoosingSecondDescription="ChoosingSecondDescription",e.GuessingSecondTeam="GuessingSecondTeam",e.GameOver="GameOver"}(D||(D={}));var B={myWord:null,players:[],seed:Object(j.a)(),status:D.WaitingForGameStart,wordList:[]},J=Object(u.b)({name:"game",initialState:B,reducers:{startGame:function(e,t){var n=t.payload,a=n.players,r=n.seed,i=n.wordList,o=function(e,t,n){var a=[null];q(t)&&a.push(null);for(var r=q(t)?t-2:t-1,i=0;i<r/2;i++)a.push(e[i],e[i]);var o=N()(n);return a.sort((function(){return o()-.5}))}(i,a.length,r);return Object(d.a)(Object(d.a)({},e),{},{players:a.map((function(e,t){return Object(d.a)(Object(d.a)({},e),{},{word:o[t]})})),seed:r,status:D.ChoosingFirstDescription,wordList:i})},addDescriptionToPlayer:function(e,t){var n=t.payload,a=n.description,r=n.id,i=e.players.find((function(e){return e.id===r}));void 0!==i&&(i.descriptions.push(a),e.players.every((function(e){return 1===e.descriptions.length}))&&(e.status=D.GuessingFirstTeam),e.players.every((function(e){return 2===e.descriptions.length}))&&(e.status=D.GuessingSecondTeam))},addGuessToPlayer:function(e,t){var n=t.payload,a=n.guess,r=n.id,i=e.players.find((function(e){return e.id===r}));void 0!==i&&(i.guesses.push(a),e.players.every((function(e){return 1===e.guesses.length}))&&(e.status=D.ChoosingSecondDescription),e.players.every((function(e){return 2===e.guesses.length}))&&(e.status=D.GameOver))}}}),E=J.reducer,Q=J.actions,z=(Q.addGuessToPlayer,Q.addDescriptionToPlayer,Q.startGame);function A(e){var t;return null===(t=e.game.players.find((function(t){return t.id===v(e)})))||void 0===t?void 0:t.word}var U=Object(u.c)({serializableCheck:!1});var Y=n(11),K=n(1654),Z=n(44),$=n(49),X=n.n($);function _(){return X()(3).join("-")}function ee(e){return"/room/".concat(e)}var te=n(65),ne=n(1666),ae=n(1650),re=n(1669),ie=n(1651),oe=n(1653),ce=n(1652),se=n(3);function le(){var e=Object(s.g)().push,t=function(){var e=Object(a.useState)((function(){return _()}));return Object(Y.a)(e,1)[0]}(),n=new URLSearchParams(Object(s.h)().search),r=g(),i=n.get("roomCode"),o=Object(a.useState)(null!==i&&void 0!==i?i:t),c=Object(Y.a)(o,2),l=c[0],u=c[1];return Object(se.jsxs)("form",{onSubmit:function(t){t.preventDefault(),r(H(!0)),e(ee(l))},style:{display:"flex",gap:12},children:[Object(se.jsx)(ne.a,{autoComplete:"off",autoFocus:!0,id:"roomCode",label:te.MainView.roomCodeLabel,value:l,variant:"standard",InputProps:{endAdornment:Object(se.jsx)(ae.a,{position:"end",children:Object(se.jsx)(re.a,{title:te.MainView.generateNewRoomCode,children:Object(se.jsx)(ie.a,{"aria-label":te.MainView.generateNewRoomCode,onClick:function(){return u(_())},children:Object(se.jsx)(ce.a,{})})})}),readOnly:!0}}),Object(se.jsx)(oe.a,{type:"submit",variant:"contained",color:"primary",children:te.MainView.createRoom})]})}function ue(){var e=w(),t=Object(Y.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(null!==n&&void 0!==n?n:""),o=Object(Y.a)(i,2),c=o[0],s=o[1];return Object(se.jsxs)("form",{onSubmit:function(e){e.preventDefault(),r(c)},style:{display:"flex",gap:12},children:[Object(se.jsx)(ne.a,{autoComplete:"off",id:"name",label:te.MainView.nameLabel,value:c,variant:"filled",onChange:function(e){return s(e.target.value)}}),Object(se.jsx)(oe.a,{type:"submit",variant:"contained",color:"primary",children:te.MainView.saveName})]})}function de(){var e=w(),t=Object(Y.a)(e,1)[0];return Object(se.jsxs)(K.a,{children:[Object(se.jsxs)(Z.a,{variant:"h3",gutterBottom:!0,children:["Hi ",null!==t&&void 0!==t?t:"there","!"]}),Object(se.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[Object(se.jsx)(ue,{}),t&&Object(se.jsx)(le,{})]})]})}n(122);function je(e){return void 0===e?"/":"/?roomCode=".concat(e)}var be=te.JoinRoomView,me=function(e){var t=e.roomCode,n=w(),a=Object(Y.a)(n,1)[0];return Object(se.jsxs)(K.a,{children:[Object(se.jsx)(Z.a,{variant:"h3",gutterBottom:!0,children:be.heading}),Object(se.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",flexDirection:"column",gap:12},children:[Object(se.jsx)(ue,{}),a&&Object(se.jsx)(oe.a,{color:"primary",variant:"contained",component:c.b,to:ee(t),children:be.joinGame})]})]})};function Oe(e){return"/invite/".concat(e)}var he=n(1664),fe=n(1619),ve=n(1649),pe=n(1665),xe=n(86),ge=n(1655),ye=n(1656),we=n(1659),Ce=n(1660),Se=n(1657),Ge=n(1658),Re=n(1661),Ve=function(e){var t=e.player,n=t.name,a=t.isOnline,r=e.isHost;return Object(se.jsxs)(ge.a,{children:[Object(se.jsx)(ye.a,{children:a?Object(se.jsx)(Se.a,{"aria-label":te.WaitingRoomView.online}):Object(se.jsx)(Ge.a,{"aria-label":te.WaitingRoomView.offline,color:"error"})}),Object(se.jsx)(we.a,{primary:n}),r&&Object(se.jsx)(Ce.a,{children:Object(se.jsx)(re.a,{title:te.WaitingRoomView.host,children:Object(se.jsx)(Re.a,{"aria-label":te.WaitingRoomView.host})})})]})},ke=Object(a.createContext)(void 0);function We(e){var t=Object(l.d)();Object(a.useEffect)((function(){!function(e,t){var n=function(e){t.dispatch(k(new S({id:e.clientId,name:e.data.name,isOnline:!0})))};e.presence.subscribe("enter",n),e.presence.subscribe("present",n),e.presence.subscribe("leave",(function(e){t.dispatch(W(e.clientId))}))}(e,t)}),[e,t])}var Le=n(1662),Te=n(1663),De=function(){var e="my-word-label",t=y(A);return Object(se.jsxs)(K.a,{children:[Object(se.jsx)(Z.a,{variant:"h3",gutterBottom:!0,children:"Game"}),null===t?te.GameRoomView.youReTheQuestionMark:Object(se.jsx)(Le.a,{children:Object(se.jsxs)(Te.a,{children:[Object(se.jsx)(Z.a,{gutterBottom:!0,id:e,children:te.GameRoomView.myWordLabel}),Object(se.jsx)(Z.a,{"aria-labelledby":e,children:t})]})})]})},Pe=n(87),He=n.n(Pe),Ie=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(C.a)(this,e),this.id=Object(j.a)(),this.name=He.a.name.firstName(),this.isOnline=!0,this.descriptions=[],this.guesses=[],Object.assign(this,t)},Me=function(e){var t=e.roomCode,n=y(v),r=w(),i=Object(Y.a)(r,1)[0],o=y(L),c=Object(a.useContext)(ke),s=Object(a.useState)((function(){return c(t)})),l=Object(Y.a)(s,1)[0];We(l),Object(a.useEffect)((function(){return l.presence.enterClient(n,{name:i}),function(){return l.presence.leaveClient(n)}}),[l,n,i]);var u,d=Object(a.useState)(!1),j=Object(Y.a)(d,2),b=j[0],m=j[1],O=g();return b?Object(se.jsx)(De,{}):Object(se.jsxs)(K.a,{children:[Object(se.jsxs)(he.a,{container:!0,justify:"space-between",alignItems:"center",children:[Object(se.jsx)(he.a,{item:!0,children:Object(se.jsx)(Z.a,{variant:"h3",gutterBottom:!0,children:"Room"})}),Object(se.jsx)(he.a,{item:!0,children:Object(se.jsx)(xe.CopyToClipboard,{text:(u=Oe(t),"".concat(window.location.protocol,"//").concat(window.location.host).concat("/qnot").concat(u)),children:Object(se.jsx)(oe.a,{variant:"contained",color:"primary",children:te.WaitingRoomView.copyInviteLink})})})]}),Object(se.jsx)(fe.a,{children:Object(se.jsx)(ve.a,{subheader:Object(se.jsx)(pe.a,{children:te.WaitingRoomView.playersListHeader}),children:o.map((function(e){return Object(se.jsx)(Ve,{player:e,isHost:!0},e.name)}))})}),Object(se.jsx)(oe.a,{onClick:function(){O(z({players:o,seed:X()(3).join("-"),wordList:["foo","bar","baz"]})),m(!0)},children:te.WaitingRoomView.startGame}),Object(se.jsx)(oe.a,{onClick:function(){return O(k(new Ie))},children:"Add mock player"})]})};function Fe(e){var t=e.roomCode,n=w(),a=Object(Y.a)(n,1)[0],r=y(I);return null===a?r?Object(se.jsx)(s.a,{to:je(t)}):Object(se.jsx)(s.a,{to:Oe(t)}):Object(se.jsx)(Me,{roomCode:t})}function Ne(){return Object(se.jsxs)(s.d,{children:[Object(se.jsx)(s.b,{path:ee(":roomCode"),children:function(e){var t=e.match;return Object(se.jsx)(Fe,{roomCode:t.params.roomCode})}}),Object(se.jsx)(s.b,{path:Oe(":roomCode"),children:function(e){var t=e.match;return Object(se.jsx)(me,{roomCode:t.params.roomCode})}}),Object(se.jsx)(s.b,{path:je(),children:Object(se.jsx)(de,{})})]})}var qe=function(e){var t=e.children,n=e.channelCreator;return Object(se.jsx)(ke.Provider,{value:n,children:t})},Be=n(88),Je="1Zn4jA.zjaEkg:uIdkQyluCE5HfYMK";var Ee=new(n.n(Be).a.Realtime)(Je).channels,Qe=Ee.get.bind(Ee),ze=function(){return Object(se.jsx)(qe,{channelCreator:Qe,children:Object(se.jsx)(c.a,{basename:"/qnot",children:Object(se.jsx)(l.a,{store:Object(u.a)({middleware:U,reducer:{game:E,me:x,players:T,roomSettings:M}}),children:Object(se.jsx)(Ne,{})})})})};o.a.render(Object(se.jsx)(r.a.StrictMode,{children:Object(se.jsx)(ze,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},65:function(e){e.exports=JSON.parse('{"MainView":{"generateNewRoomCode":"Generate new room code","nameLabel":"Name","saveName":"Save name","roomCodeLabel":"Room code","createRoom":"Create room"},"WaitingRoomView":{"copyInviteLink":"Copy invite link","host":"This is the host","offline":"offline","online":"online","playersListHeader":"Players","startGame":"Start game"},"JoinRoomView":{"heading":"Welcome to Qnot!","joinGame":"Join game"},"GameRoomView":{"myWordLabel":"Your word","youReTheQuestionMark":"You are the question mark"}}')}},[[1618,1,2]]]);
//# sourceMappingURL=main.40608a1f.chunk.js.map