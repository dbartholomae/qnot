(this.webpackJsonpqnot=this.webpackJsonpqnot||[]).push([[0],{119:function(e,t){},1618:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(10),o=n.n(i);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=n(46),s=n(14);var l=n(29),u=n(22),d=n(17),j=n(1667);function b(e,t){return localStorage.setItem("qnot/".concat(e),t),t}function m(e){var t;return null!==(t=localStorage.getItem("qnot/".concat(e)))&&void 0!==t?t:null}var O={id:function(){var e;return null!==(e=m("id"))&&void 0!==e?e:b("id",Object(j.a)())}(),name:m("name")},h=Object(u.b)({name:"me",initialState:O,reducers:{setName:function(e,t){return Object(d.a)(Object(d.a)({},e),{},{name:t.payload})}}}),f=function(e){return e.me.name},p=function(e){return e.me.id},v=h.actions.setName,g=h.reducer,y=function(){return Object(l.b)()},x=l.c;function w(){var e=x(f),t=y();return[e,function(e){b("name",e),t(v(e))}]}var C=n(37),S=function e(t){var n=t.id,r=void 0===n?Object(j.a)():n,a=t.name,i=t.isOnline;Object(C.a)(this,e),this.id=void 0,this.name=void 0,this.isOnline=void 0,this.word=void 0,this.descriptions=[],this.guesses=[],this.name=a,this.isOnline=i,this.id=r},G=n(12),R=Object(u.b)({name:"players",initialState:{},reducers:{addOrUpdatePlayer:function(e,t){var n=t.payload;return Object(d.a)(Object(d.a)({},e),{},Object(G.a)({},n.id,n))},markPlayerOffline:function(e,t){var n=t.payload;void 0!==e[n]&&(e[n].isOnline=!1)}}}),V=R.actions,k=V.addOrUpdatePlayer,T=V.markPlayerOffline,W=function(e){return Object.values(e.players)},L=R.reducer;var D,P=Object(u.b)({name:"roomSettings",initialState:{isHost:!1},reducers:{setHost:function(e,t){return Object(d.a)(Object(d.a)({},e),{},{isHost:t.payload})}}}),F=P.actions.setHost,H=function(e){return function(e){return e.roomSettings}(e).isHost},I=P.reducer,M=n(81),N=n.n(M);function q(e){return e%2===0}!function(e){e.WaitingForGameStart="WaitingForGameStart",e.ChoosingFirstDescription="ChoosingFirstDescription",e.GuessingFirstTeam="GuessingFirstTeam",e.ChoosingSecondDescription="ChoosingSecondDescription",e.GuessingSecondTeam="GuessingSecondTeam",e.GameOver="GameOver"}(D||(D={}));var B={myWord:null,players:[],seed:Object(j.a)(),status:D.WaitingForGameStart,wordList:[]},J=Object(u.b)({name:"game",initialState:B,reducers:{startGame:function(e,t){var n=t.payload,r=n.players,a=n.seed,i=n.wordList,o=function(e,t,n){var r=[null];q(t)&&r.push(null);for(var a=q(t)?t-2:t-1,i=0;i<a/2;i++)r.push(e[i],e[i]);var o=N()(n);return r.sort((function(){return o()-.5}))}(i,r.length,a);return Object(d.a)(Object(d.a)({},e),{},{players:r.map((function(e,t){return Object(d.a)(Object(d.a)({},e),{},{word:o[t]})})),seed:a,status:D.ChoosingFirstDescription,wordList:i})},addFirstDescriptionToPlayer:function(e,t){var n=t.payload,r=n.description,a=n.id,i=e.players.find((function(e){return e.id===a}));void 0!==i&&(i.descriptions.push(r),e.players.every((function(e){return 1===e.descriptions.length}))&&(e.status=D.GuessingFirstTeam),e.players.every((function(e){return 2===e.descriptions.length}))&&(e.status=D.GuessingSecondTeam))},addSecondDescriptionToPlayer:function(e,t){var n=t.payload,r=n.description,a=n.id,i=e.players.find((function(e){return e.id===a}));void 0!==i&&(i.descriptions.push(r),e.players.every((function(e){return 1===e.descriptions.length}))&&(e.status=D.GuessingFirstTeam),e.players.every((function(e){return 2===e.descriptions.length}))&&(e.status=D.GuessingSecondTeam))},addGuessToPlayer:function(e,t){var n=t.payload,r=n.guess,a=n.id,i=e.players.find((function(e){return e.id===a}));void 0!==i&&(i.guesses.push(r),e.players.every((function(e){return 1===e.guesses.length}))&&(e.status=D.ChoosingSecondDescription),e.players.every((function(e){return 2===e.guesses.length}))&&(e.status=D.GameOver))}}}),E=J.reducer,Q=J.actions,z=(Q.addGuessToPlayer,Q.addFirstDescriptionToPlayer,Q.addSecondDescriptionToPlayer,Q.startGame);function A(e){var t;return null===(t=e.game.players.find((function(t){return t.id===p(e)})))||void 0===t?void 0:t.word}var U=Object(u.c)({serializableCheck:!1});var Y=n(11),K=n(1654),Z=n(44),$=n(49),X=n.n($);function _(){return X()(3).join("-")}function ee(e){return"/room/".concat(e)}var te=n(65),ne=n(1666),re=n(1650),ae=n(1669),ie=n(1651),oe=n(1653),ce=n(1652),se=n(3);function le(){var e=Object(s.g)().push,t=function(){var e=Object(r.useState)((function(){return _()}));return Object(Y.a)(e,1)[0]}(),n=new URLSearchParams(Object(s.h)().search),a=y(),i=n.get("roomCode"),o=Object(r.useState)(null!==i&&void 0!==i?i:t),c=Object(Y.a)(o,2),l=c[0],u=c[1];return Object(se.jsxs)("form",{onSubmit:function(t){t.preventDefault(),a(F(!0)),e(ee(l))},style:{display:"flex",gap:12},children:[Object(se.jsx)(ne.a,{autoComplete:"off",autoFocus:!0,id:"roomCode",label:te.MainView.roomCodeLabel,value:l,variant:"standard",InputProps:{endAdornment:Object(se.jsx)(re.a,{position:"end",children:Object(se.jsx)(ae.a,{title:te.MainView.generateNewRoomCode,children:Object(se.jsx)(ie.a,{"aria-label":te.MainView.generateNewRoomCode,onClick:function(){return u(_())},children:Object(se.jsx)(ce.a,{})})})}),readOnly:!0}}),Object(se.jsx)(oe.a,{type:"submit",variant:"contained",color:"primary",children:te.MainView.createRoom})]})}function ue(){var e=w(),t=Object(Y.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)(null!==n&&void 0!==n?n:""),o=Object(Y.a)(i,2),c=o[0],s=o[1];return Object(se.jsxs)("form",{onSubmit:function(e){e.preventDefault(),a(c)},style:{display:"flex",gap:12},children:[Object(se.jsx)(ne.a,{autoComplete:"off",id:"name",label:te.MainView.nameLabel,value:c,variant:"filled",onChange:function(e){return s(e.target.value)}}),Object(se.jsx)(oe.a,{type:"submit",variant:"contained",color:"primary",children:te.MainView.saveName})]})}function de(){var e=w(),t=Object(Y.a)(e,1)[0];return Object(se.jsxs)(K.a,{children:[Object(se.jsxs)(Z.a,{variant:"h3",gutterBottom:!0,children:["Hi ",null!==t&&void 0!==t?t:"there","!"]}),Object(se.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[Object(se.jsx)(ue,{}),t&&Object(se.jsx)(le,{})]})]})}n(122);function je(e){return void 0===e?"/":"/?roomCode=".concat(e)}var be=te.JoinRoomView,me=function(e){var t=e.roomCode,n=w(),r=Object(Y.a)(n,1)[0];return Object(se.jsxs)(K.a,{children:[Object(se.jsx)(Z.a,{variant:"h3",gutterBottom:!0,children:be.heading}),Object(se.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",flexDirection:"column",gap:12},children:[Object(se.jsx)(ue,{}),r&&Object(se.jsx)(oe.a,{color:"primary",variant:"contained",component:c.b,to:ee(t),children:be.joinGame})]})]})};function Oe(e){return"/invite/".concat(e)}var he=n(1664),fe=n(1619),pe=n(1649),ve=n(1665),ge=n(86),ye=n(1655),xe=n(1656),we=n(1659),Ce=n(1660),Se=n(1657),Ge=n(1658),Re=n(1661),Ve=function(e){var t=e.player,n=t.name,r=t.isOnline,a=e.isHost;return Object(se.jsxs)(ye.a,{children:[Object(se.jsx)(xe.a,{children:r?Object(se.jsx)(Se.a,{"aria-label":te.WaitingRoomView.online}):Object(se.jsx)(Ge.a,{"aria-label":te.WaitingRoomView.offline,color:"error"})}),Object(se.jsx)(we.a,{primary:n}),a&&Object(se.jsx)(Ce.a,{children:Object(se.jsx)(ae.a,{title:te.WaitingRoomView.host,children:Object(se.jsx)(Re.a,{"aria-label":te.WaitingRoomView.host})})})]})},ke=Object(r.createContext)(void 0);function Te(e){var t=Object(l.d)();Object(r.useEffect)((function(){!function(e,t){var n=function(e){t.dispatch(k(new S({id:e.clientId,name:e.data.name,isOnline:!0})))};e.presence.subscribe("enter",n),e.presence.subscribe("present",n),e.presence.subscribe("leave",(function(e){t.dispatch(T(e.clientId))}))}(e,t)}),[e,t])}var We=n(1662),Le=n(1663),De=function(){var e="my-word-label",t=x(A);return Object(se.jsxs)(K.a,{children:[Object(se.jsx)(Z.a,{variant:"h3",gutterBottom:!0,children:"Game"}),null===t?te.GameRoomView.youReTheQuestionMark:Object(se.jsx)(We.a,{children:Object(se.jsxs)(Le.a,{children:[Object(se.jsx)(Z.a,{gutterBottom:!0,id:e,children:te.GameRoomView.myWordLabel}),Object(se.jsx)(Z.a,{"aria-labelledby":e,children:t})]})})]})},Pe=n(87),Fe=n.n(Pe),He=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(C.a)(this,e),this.id=Object(j.a)(),this.name=Fe.a.name.firstName(),this.isOnline=!0,this.descriptions=[],this.guesses=[],Object.assign(this,t)},Ie=function(e){var t=e.roomCode,n=x(p),a=w(),i=Object(Y.a)(a,1)[0],o=x(W),c=Object(r.useContext)(ke),s=Object(r.useState)((function(){return c(t)})),l=Object(Y.a)(s,1)[0];Te(l),Object(r.useEffect)((function(){return l.presence.enterClient(n,{name:i}),function(){return l.presence.leaveClient(n)}}),[l,n,i]);var u,d=Object(r.useState)(!1),j=Object(Y.a)(d,2),b=j[0],m=j[1],O=y();return b?Object(se.jsx)(De,{}):Object(se.jsxs)(K.a,{children:[Object(se.jsxs)(he.a,{container:!0,justify:"space-between",alignItems:"center",children:[Object(se.jsx)(he.a,{item:!0,children:Object(se.jsx)(Z.a,{variant:"h3",gutterBottom:!0,children:"Room"})}),Object(se.jsx)(he.a,{item:!0,children:Object(se.jsx)(ge.CopyToClipboard,{text:(u=Oe(t),"".concat(window.location.protocol,"//").concat(window.location.host).concat("/qnot").concat(u)),children:Object(se.jsx)(oe.a,{variant:"contained",color:"primary",children:te.WaitingRoomView.copyInviteLink})})})]}),Object(se.jsx)(fe.a,{children:Object(se.jsx)(pe.a,{subheader:Object(se.jsx)(ve.a,{children:te.WaitingRoomView.playersListHeader}),children:o.map((function(e){return Object(se.jsx)(Ve,{player:e,isHost:!0},e.name)}))})}),Object(se.jsx)(oe.a,{onClick:function(){O(z({players:o,seed:X()(3).join("-"),wordList:["foo","bar","baz"]})),m(!0)},children:te.WaitingRoomView.startGame}),Object(se.jsx)(oe.a,{onClick:function(){return O(k(new He))},children:"Add mock player"})]})};function Me(e){var t=e.roomCode,n=w(),r=Object(Y.a)(n,1)[0],a=x(H);return null===r?a?Object(se.jsx)(s.a,{to:je(t)}):Object(se.jsx)(s.a,{to:Oe(t)}):Object(se.jsx)(Ie,{roomCode:t})}function Ne(){return Object(se.jsxs)(s.d,{children:[Object(se.jsx)(s.b,{path:ee(":roomCode"),children:function(e){var t=e.match;return Object(se.jsx)(Me,{roomCode:t.params.roomCode})}}),Object(se.jsx)(s.b,{path:Oe(":roomCode"),children:function(e){var t=e.match;return Object(se.jsx)(me,{roomCode:t.params.roomCode})}}),Object(se.jsx)(s.b,{path:je(),children:Object(se.jsx)(de,{})})]})}var qe=function(e){var t=e.children,n=e.channelCreator;return Object(se.jsx)(ke.Provider,{value:n,children:t})},Be=n(88),Je="1Zn4jA.zjaEkg:uIdkQyluCE5HfYMK";var Ee=new(n.n(Be).a.Realtime)(Je).channels,Qe=Ee.get.bind(Ee),ze=function(){return Object(se.jsx)(qe,{channelCreator:Qe,children:Object(se.jsx)(c.a,{basename:"/qnot",children:Object(se.jsx)(l.a,{store:Object(u.a)({middleware:U,reducer:{game:E,me:g,players:L,roomSettings:I}}),children:Object(se.jsx)(Ne,{})})})})};o.a.render(Object(se.jsx)(a.a.StrictMode,{children:Object(se.jsx)(ze,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},65:function(e){e.exports=JSON.parse('{"MainView":{"generateNewRoomCode":"Generate new room code","nameLabel":"Name","saveName":"Save name","roomCodeLabel":"Room code","createRoom":"Create room"},"WaitingRoomView":{"copyInviteLink":"Copy invite link","host":"This is the host","offline":"offline","online":"online","playersListHeader":"Players","startGame":"Start game"},"JoinRoomView":{"heading":"Welcome to Qnot!","joinGame":"Join game"},"GameRoomView":{"myWordLabel":"Your word","youReTheQuestionMark":"You are the question mark"}}')}},[[1618,1,2]]]);
//# sourceMappingURL=main.479c155f.chunk.js.map